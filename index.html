<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Greek Alphabet Trainer</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#0f172a" />
  <script>
    if ('serviceWorker' in navigator) {
      addEventListener('load', () => navigator.serviceWorker.register('./service-worker.js'));
    }
  </script>
  <link rel="preload" href="app.js" as="script">
  <style>
    :root { --bg:#0f172a; --text:#e5e7eb; --muted:#9ca3af; --accent:#38bdf8; --good:#22c55e; --bad:#ef4444; --warn:#f59e0b; }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Noto Sans; color:var(--text);
      background:radial-gradient(1200px 600px at 100% -10%, #10203a, #0a1020 60%, #070b16 100%), var(--bg); }
    header{ display:flex; align-items:center; justify-content:space-between; padding:16px 20px; position:sticky; top:0; backdrop-filter:blur(8px);
      background:linear-gradient(180deg, rgba(10,16,32,.8), rgba(10,16,32,.4)); border-bottom:1px solid rgba(255,255,255,.06); z-index:10; }
    header h1{ margin:0; font-size:20px; display:flex; gap:10px; align-items:center; }
    .badge{ font-size:12px; color:var(--bg); background:var(--accent); padding:2px 8px; border-radius:999px; }
    nav{ display:flex; gap:8px; flex-wrap:wrap; }
    nav button{ background:#0b1220; color:var(--text); border:1px solid rgba(255,255,255,.08); border-radius:10px; padding:8px 12px; cursor:pointer; }
    nav button.active{ background:#13223c; border-color:rgba(56,189,248,.6); box-shadow:0 0 0 2px rgba(56,189,248,.2) inset; }
    main{ padding:20px; max-width:1100px; margin:0 auto; display:grid; gap:16px; }
    .panel{ background:linear-gradient(180deg, rgba(17,24,39,.8), rgba(17,24,39,.6)); border:1px solid rgba(255,255,255,.08); border-radius:16px; padding:16px; box-shadow:0 10px 30px rgba(0,0,0,.25); }
    .grid-2{ display:grid; grid-template-columns:1fr 1fr; gap:16px; } @media (max-width:900px){ .grid-2{ grid-template-columns:1fr; } }
    .row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; } .spacer{ flex:1; } .card{ display:grid; gap:12px; align-items:center; text-align:center; }

    .glyph{ font-size:clamp(96px, 14vw, 160px); line-height:1; margin:0; font-weight:700; }
    .subglyph{ font-size:clamp(80px, 12vw, 120px); color:var(--muted); line-height:1; margin:0; font-weight:700; }
    .name{ font-size:28px; margin:0; }
    .pron{ color:var(--muted); font-size:14px; margin:0; }
    .usage{ color:var(--muted); font-size:13px; margin:0; }

    .controls button, .controls select, .controls input[type=text]{
      background:#0b1220; color:var(--text); border:1px solid rgba(255,255,255,.1); border-radius:10px; padding:10px 12px; cursor:pointer; font-size:16px;
    }
    select { font-size:18px; }
    .controls button.primary{ border-color:rgba(56,189,248,.6); }
    .controls button.good{ border-color:rgba(34,197,94,.6); }
    .controls button.warn{ border-color:rgba(245,158,11,.6); }
    .controls button.bad{ border-color:rgba(239,68,68,.6); }
    .controls .tiny{ padding:6px 8px; font-size:12px; }
    .learned-state { background:#083314; border-color:rgba(34,197,94,.6); }

    .letters{ display:grid; grid-template-columns:repeat(auto-fill, minmax(90px, 1fr)); gap:10px; }
    .pill{ padding:10px; text-align:center; border:1px solid rgba(255,255,255,.1); background:#0b1220; border-radius:12px; cursor:pointer; }
    .pill.learned{ outline:2px solid rgba(34,197,94,.6); }
    .pill .upper{ display:block; font-size:30px; }
    .pill .lower{ display:block; color:var(--muted); font-size:20px; }

    .canvas-wrap{ position:relative; width:100%; max-width:520px; margin:0 auto; aspect-ratio:1/1; background:#0b1220; border:1px dashed rgba(255,255,255,.1); border-radius:12px; overflow:hidden; }
    canvas{ width:100%; height:100%; display:block; }
    .ghost-letter{ position:absolute; inset:0; display:grid; place-items:center; color:rgba(255,255,255,.07); font-size:min(55vw, 55vh); user-select:none; pointer-events:none; font-weight:800; }

    .quiz-q{ font-size:22px; margin:8px 0 4px 0; }
    .quiz-options{ display:grid; grid-template-columns:repeat(auto-fit, minmax(140px, 1fr)); gap:10px; margin-top:8px; }
    .quiz-options button{ padding:14px; border-radius:12px; border:1px solid rgba(255,255,255,.1); background:#0b1220; color:var(--text); cursor:pointer; }
    .quiz-options button.correct{ outline:3px solid rgba(34,197,94,.7); }
    .quiz-options button.incorrect{ outline:3px solid rgba(239,68,68,.7); }
    .stat{ font-variant-numeric:tabular-nums; background:#0b1220; border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:8px 10px; }

    #blocks { display:flex; gap:10px; flex-wrap:wrap; min-height:60px; padding:10px; border:1px dashed rgba(255,255,255,.15); border-radius:12px; background:#0b1220; }
    .block { padding:14px 18px; background:#111b34; border:1px solid rgba(255,255,255,.12); border-radius:12px; cursor:grab; font-size:28px; user-select:none; }
    .target { padding:10px; color:var(--muted); }

    footer{ text-align:center; color:var(--muted); padding:30px 10px; font-size:12px; }
    a{ color:var(--accent); }
  </style>
</head>
<body>
  <header>
    <h1>Greek Alphabet Trainer <span class="badge">PWA</span></h1>
    <nav>
      <button class="tab-btn active" data-tab="learn">Learn</button>
      <button class="tab-btn" data-tab="trace">Trace</button>
      <button class="tab-btn" data-tab="quiz">Quiz</button>
      <button class="tab-btn" data-tab="progress">Progress</button>
      <button class="tab-btn" data-tab="blocks">Blocks Game</button>
    </nav>
  </header>

  <main>
    <section id="learn" class="panel">
      <div class="row controls">
        <button id="prevLetter" class="tiny">◀ Prev</button>
        <button id="nextLetter" class="tiny">Next ▶</button>
        <div class="spacer"></div>
        <label>Voice: <select id="voiceSelect"></select></label>
        <button id="speakBtn" class="primary">🔊 Pronounce</button>
      </div>
      <div class="grid-2">
        <div class="card">
          <div>
            <p id="glyphUpper" class="glyph">Α</p>
            <p id="glyphLower" class="subglyph">α</p>
          </div>
          <div>
            <p id="name" class="name">alpha</p>
            <p id="pron" class="pron">AL-fuh (US math)</p>
            <p id="usage" class="usage">Common in angles; α often denotes an angle.</p>
          </div>
          <div class="row controls" style="justify-content:center;">
            <button id="markLearned" class="good">Mark learned ✓</button>
            <button id="resetLearned" class="warn">Unmark</button>
          </div>
        </div>

        <div class="panel">
          <h3 style="margin-top:0;">All letters</h3>
          <div id="lettersList" class="letters"></div>
        </div>
      </div>
    </section>

    <section id="trace" class="panel" hidden>
      <div class="row controls">
        <label>Letter: <select id="traceSelect"></select></label>
        <label>Case:
          <select id="traceCase">
            <option value="upper">Uppercase</option>
            <option value="lower">Lowercase</option>
          </select>
        </label>
        <div class="spacer"></div>
        <button id="erase" class="bad">Clear</button>
        <button id="savePNG" class="primary">Save as PNG</button>
      </div>
      <div class="canvas-wrap">
        <div id="ghost" class="ghost-letter">Α</div>
        <canvas id="pad" width="600" height="600"></canvas>
      </div>
      <p class="pron" style="margin-top:8px;">Tip: Trace along the faint letter. Use a slow, steady stroke. Click <b>Save as PNG</b> to export your tracing.</p>
    </section>

    <section id="quiz" class="panel" hidden>
      <div class="row controls">
        <label>Mode:
          <select id="quizMode">
            <option value="see-name">See a letter → pick its name</option>
            <option value="hear-letter">Hear the name → pick the letter</option>
            <option value="type-name">See a letter → type its name</option>
            <option value="state-capital">Letter → pick US state (capital initial matches)</option>
          </select>
        </label>
        <label>Scope:
          <select id="quizScope">
            <option value="all">All letters</option>
            <option value="unlearned">Only unlearned</option>
            <option value="learned">Only learned</option>
          </select>
        </label>
        <label>Round size:
          <select id="roundSize">
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="50">50</option>
          </select>
        </label>
        <div class="spacer"></div>
        <span class="stat">Q: <span id="roundN">0</span>/<span id="roundTotal">10</span></span>
        <span class="stat">Score: <span id="score">0</span>/<span id="scoreOutOf">10</span></span>
        <button id="newQ" class="primary">New Round</button>
      </div>
      <div id="quizBody" class="panel" style="min-height:180px;">
        <div id="qText" class="quiz-q">Pick a mode and start a new round.</div>
        <div id="quizOptions" class="quiz-options"></div>
        <div id="quizFree" class="row" style="margin-top:8px;"></div>
      </div>
    </section>

    <section id="progress" class="panel" hidden>
      <h3 style="margin-top:0;">Your progress</h3>
      <div class="letters" id="progressList"></div>
      <div class="row" style="margin-top:12px;">
        <div class="spacer"></div>
        <button id="resetAll" class="bad">Reset progress</button>
      </div>
    </section>

    <section id="blocks" class="panel" hidden>
      <div class="row controls">
        <span class="target">Form this word/prefix: <b><span id="targetLatin">meta</span></b></span>
        <div class="spacer"></div>
        <button id="newBlocks" class="primary">New Puzzle</button>
      </div>
      <div id="blocks" aria-label="draggable blocks area"></div>
      <div id="blocksFeedback" class="pron" style="margin-top:8px;"></div>
    </section>
  </main>

  <footer>Built for learning the Greek alphabet with US‑style math pronunciations. Install via “Add to Home Screen”.</footer>

  <script src="app.js"></script>
</body>
</html>
