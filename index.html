<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Greek Alphabet Trainer</title>
<link rel="manifest" href="manifest.json" />
<meta name="theme-color" content="#0f172a" />
<script>if('serviceWorker'in navigator){addEventListener('load',()=>navigator.serviceWorker.register('./service-worker.js'))}</script>
<style>
:root{--bg:#0f172a;--text:#e5e7eb;--muted:#9ca3af;--accent:#38bdf8;--good:#22c55e;--bad:#ef4444;--warn:#f59e0b}
*{box-sizing:border-box}html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,Noto Sans;color:var(--text);background:radial-gradient(1200px 600px at 100% -10%,#10203a,#0a1020 60%,#070b16 100%),var(--bg)}
header{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;position:sticky;top:0;backdrop-filter:blur(8px);background:linear-gradient(180deg,rgba(10,16,32,.8),rgba(10,16,32,.4));border-bottom:1px solid rgba(255,255,255,.06);z-index:10}
header h1{margin:0;font-size:20px;display:flex;gap:10px;align-items:center}.badge{font-size:12px;color:var(--bg);background:var(--accent);padding:2px 8px;border-radius:999px}
nav{display:flex;gap:8px;flex-wrap:wrap}nav button{background:#0b1220;color:var(--text);border:1px solid rgba(255,255,255,.08);border-radius:10px;padding:8px 12px;cursor:pointer}nav button.active{background:#13223c;border-color:rgba(56,189,248,.6);box-shadow:0 0 0 2px rgba(56,189,248,.2) inset}
main{padding:20px;max-width:1100px;margin:0 auto;display:grid;gap:16px}.panel{background:linear-gradient(180deg,rgba(17,24,39,.8),rgba(17,24,39,.6));border:1px solid rgba(255,255,255,.08);border-radius:16px;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:16px}@media(max-width:900px){.grid-2{grid-template-columns:1fr}}.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}.spacer{flex:1}.card{display:grid;gap:12px;align-items:center;text-align:center}
.glyph{font-size:clamp(96px,14vw,160px);line-height:1;margin:0;font-weight:700}.subglyph{font-size:clamp(80px,12vw,120px);line-height:1;margin:0;font-weight:700;color:var(--muted)}
.name{font-size:28px;margin:0}.pron{color:var(--muted);font-size:14px;margin:0}.usage{color:var(--muted);font-size:13px;margin:0}
.controls button,.controls select,.controls input[type=text]{background:#0b1220;color:var(--text);border:1px solid rgba(255,255,255,.1);border-radius:10px;padding:10px 12px;cursor:pointer;font-size:16px}select{font-size:18px}
.controls button.primary{border-color:rgba(56,189,248,.6)}.controls button.good{border-color:rgba(34,197,94,.6)}.controls button.warn{border-color:rgba(245,158,11,.6)}.controls button.bad{border-color:rgba(239,68,68,.6)}.controls .tiny{padding:6px 8px;font-size:12px}
.learned-state{background:#083314;border-color:rgba(34,197,94,.6)}
.letters{display:grid;grid-template-columns:repeat(auto-fill,minmax(90px,1fr));gap:10px}.pill{padding:10px;text-align:center;border:1px solid rgba(255,255,255,.1);background:#0b1220;border-radius:12px;cursor:pointer}.pill.learned{outline:2px solid rgba(34,197,94,.6)}.pill .upper{font-size:30px;display:block}.pill .lower{font-size:20px;display:block;color:var(--muted)}
.canvas-wrap{position:relative;width:100%;max-width:520px;margin:0 auto;aspect-ratio:1/1;background:#0b1220;border:1px dashed rgba(255,255,255,.1);border-radius:12px;overflow:hidden}canvas{width:100%;height:100%;display:block}.ghost-letter{position:absolute;inset:0;display:grid;place-items:center;color:rgba(255,255,255,.07);font-size:min(55vw,55vh);user-select:none;pointer-events:none;font-weight:800}
.quiz-q{font-size:22px;margin:8px 0 4px 0}.quiz-options{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:10px;margin-top:8px}.quiz-options button{padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,.1);background:#0b1220;color:var(--text);cursor:pointer}.quiz-options button.correct{outline:3px solid rgba(34,197,94,.7)}.quiz-options button.incorrect{outline:3px solid rgba(239,68,68,.7)}.stat{font-variant-numeric:tabular-nums;background:#0b1220;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:8px 10px}
#blocks{display:flex;gap:10px;flex-wrap:wrap;min-height:60px;padding:10px;border:1px dashed rgba(255,255,255,.15);border-radius:12px;background:#0b1220}.block{padding:14px 18px;background:#111b34;border:1px solid rgba(255,255,255,.12);border-radius:12px;cursor:grab;font-size:28px;user-select:none}.target{padding:10px;color:var(--muted)}
footer{text-align:center;color:var(--muted);padding:30px 10px;font-size:12px}a{color:var(--accent)}
</style></head><body>
<header><h1>Greek Alphabet Trainer <span class="badge">PWA</span></h1><nav>
<button class="tab-btn active" data-tab="learn">Learn</button><button class="tab-btn" data-tab="trace">Trace</button><button class="tab-btn" data-tab="quiz">Quiz</button><button class="tab-btn" data-tab="progress">Progress</button><button class="tab-btn" data-tab="blocks">Blocks Game</button>
</nav></header>
<main>
<section id="learn" class="panel"><div class="row controls"><button id="prevLetter" class="tiny">â—€ Prev</button><button id="nextLetter" class="tiny">Next â–¶</button><div class="spacer"></div><label>Voice: <select id="voiceSelect"></select></label><button id="speakBtn" class="primary">ðŸ”Š Pronounce</button></div>
<div class="grid-2"><div class="card"><div><p id="glyphUpper" class="glyph">Î‘</p><p id="glyphLower" class="subglyph">Î±</p></div><div><p id="name" class="name">alpha</p><p id="pron" class="pron">AL-fuh (US math)</p><p id="usage" class="usage">Common in angles; Î± often denotes an angle.</p></div>
<div class="row controls" style="justify-content:center;"><button id="markLearned" class="good">Mark learned âœ“</button><button id="resetLearned" class="warn">Unmark</button></div></div><div class="panel"><h3 style="margin-top:0;">All letters</h3><div id="lettersList" class="letters"></div></div></div></section>
<section id="trace" class="panel" hidden><div class="row controls"><label>Letter: <select id="traceSelect"></select></label><label>Case: <select id="traceCase"><option value="upper">Uppercase</option><option value="lower">Lowercase</option></select></label><div class="spacer"></div><button id="erase" class="bad">Clear</button><button id="savePNG" class="primary">Save as PNG</button></div>
<div class="canvas-wrap"><div id="ghost" class="ghost-letter">Î‘</div><canvas id="pad" width="600" height="600"></canvas></div><p class="pron" style="margin-top:8px;">Tip: Trace along the faint letter. Use a slow, steady stroke.</p></section>
<section id="quiz" class="panel" hidden><div class="row controls">
<label>Mode: <select id="quizMode"><option value="see-name">See a letter â†’ pick its name</option><option value="hear-letter">Hear the name â†’ pick the letter</option><option value="type-name">See a letter â†’ type its name</option><option value="state-capital">Letter â†’ pick US state (capital initial matches)</option></select></label>
<label>Scope: <select id="quizScope"><option value="all">All letters</option><option value="unlearned">Only unlearned</option><option value="learned">Only learned</option></select></label>
<label>Round size: <select id="roundSize"><option>10</option><option>20</option><option>50</option></select></label>
<div class="spacer"></div><span class="stat">Q: <span id="roundN">0</span>/<span id="roundTotal">10</span></span><span class="stat">Score: <span id="score">0</span>/<span id="scoreOutOf">10</span></span><button id="newQ" class="primary">New Round</button></div>
<div id="quizBody" class="panel" style="min-height:180px;"><div id="qText" class="quiz-q">Pick a mode and start a new round.</div><div id="quizOptions" class="quiz-options"></div><div id="quizFree" class="row" style="margin-top:8px;"></div></div></section>
<section id="progress" class="panel" hidden><h3 style="margin-top:0;">Your progress</h3><div class="letters" id="progressList"></div><div class="row" style="margin-top:12px;"><div class="spacer"></div><button id="resetAll" class="bad">Reset progress</button></div></section>
<section id="blocks" class="panel" hidden><div class="row controls"><span class="target">Form this word/prefix: <b><span id="targetLatin">meta</span></b></span><div class="spacer"></div><button id="newBlocks" class="primary">New Puzzle</button></div><div id="blocks" aria-label="draggable blocks area"></div><div id="blocksFeedback" class="pron" style="margin-top:8px;"></div></section>
</main><footer>Built for learning the Greek alphabet with USâ€‘style math pronunciations.</footer>
<script>
const LETTERS=[
{u:'Î‘',l:'Î±',name:'alpha',pron:'AL-fuh',usage:'Angle; learning rate; significance level Î±.',alt:['AL-fa']},
{u:'Î’',l:'Î²',name:'beta',pron:'BAY-tuh',usage:'Beta coefficient; second item.',alt:['BEE-tuh']},
{u:'Î“',l:'Î³',name:'gamma',pron:'GAM-uh',usage:'Gamma function Î“; Eulerâ€“Mascheroni Î³.'},
{u:'Î”',l:'Î´',name:'delta',pron:'DEL-tuh',usage:'Change (Î”x); small change Î´.'},
{u:'Î•',l:'Îµ',name:'epsilon',pron:'EP-sih-lon',usage:'A small positive number Îµ.'},
{u:'Î–',l:'Î¶',name:'zeta',pron:'ZAY-tuh',usage:'Riemann zeta Î¶(s).'},
{u:'Î—',l:'Î·',name:'eta',pron:'AY-tuh',usage:'Efficiency Î·; viscosity.'},
{u:'Î˜',l:'Î¸',name:'theta',pron:'THAY-tuh',usage:'Angle Î¸; step size.'},
{u:'Î™',l:'Î¹',name:'iota',pron:'eye-OH-tuh',usage:'A tiny amount (not one iota).'},
{u:'Îš',l:'Îº',name:'kappa',pron:'KAP-uh',usage:'Curvature Îº; kappa statistic.'},
{u:'Î›',l:'Î»',name:'lambda',pron:'LAM-duh',usage:'Eigenvalues Î»; wavelength.'},
{u:'Îœ',l:'Î¼',name:'mu',pron:'MYOO',usage:'Mean Î¼; coefficient of friction.'},
{u:'Î',l:'Î½',name:'nu',pron:'NOO',usage:'Frequency Î½; degrees of freedom.'},
{u:'Îž',l:'Î¾',name:'xi',pron:'ZAI (or ksee)',usage:'Random variable Î¾; Greek letter Xi.',alt:['ksee']},
{u:'ÎŸ',l:'Î¿',name:'omicron',pron:'OM-ih-kron',usage:'Rare in math; the letter ÎŸ/Î¿.'},
{u:'Î ',l:'Ï€',name:'pi',pron:'PIE',usage:'Circle constant Ï€ â‰ˆ 3.14159.'},
{u:'Î¡',l:'Ï',name:'rho',pron:'ROH',usage:'Density Ï; correlation coefficient.'},
{u:'Î£',l:'Ïƒ',name:'sigma',pron:'SIG-muh',usage:'Sum Î£; standard deviation Ïƒ; final Ïƒ = Ï‚.'},
{u:'Î¤',l:'Ï„',name:'tau',pron:'TOW',usage:'Time constant Ï„; sometimes 2Ï€.'},
{u:'Î¥',l:'Ï…',name:'upsilon',pron:'OOP-sih-lon',usage:'Rare in math; particle Î¥ (upsilon).'},
{u:'Î¦',l:'Ï†',name:'phi',pron:'FIE',usage:'Golden ratio Ï†; polar angle.',alt:['fee']},
{u:'Î§',l:'Ï‡',name:'chi',pron:'KAI',usage:'Chiâ€‘square Ï‡Â²; characteristic function.'},
{u:'Î¨',l:'Ïˆ',name:'psi',pron:'SAI',usage:'Wavefunction Ïˆ; psychology symbol.'},
{u:'Î©',l:'Ï‰',name:'omega',pron:'oh-MAY-guh',usage:'Angular frequency Ï‰; bigâ€‘Î© notation.'}
];
const STATES=[["Alabama","Montgomery"],["Alaska","Juneau"],["Arizona","Phoenix"],["Arkansas","Little Rock"],["California","Sacramento"],["Colorado","Denver"],["Connecticut","Hartford"],["Delaware","Dover"],["Florida","Tallahassee"],["Georgia","Atlanta"],["Hawaii","Honolulu"],["Idaho","Boise"],["Illinois","Springfield"],["Indiana","Indianapolis"],["Iowa","Des Moines"],["Kansas","Topeka"],["Kentucky","Frankfort"],["Louisiana","Baton Rouge"],["Maine","Augusta"],["Maryland","Annapolis"],["Massachusetts","Boston"],["Michigan","Lansing"],["Minnesota","Saint Paul"],["Mississippi","Jackson"],["Missouri","Jefferson City"],["Montana","Helena"],["Nebraska","Lincoln"],["Nevada","Carson City"],["New Hampshire","Concord"],["New Jersey","Trenton"],["New Mexico","Santa Fe"],["New York","Albany"],["North Carolina","Raleigh"],["North Dakota","Bismarck"],["Ohio","Columbus"],["Oklahoma","Oklahoma City"],["Oregon","Salem"],["Pennsylvania","Harrisburg"],["Rhode Island","Providence"],["South Carolina","Columbia"],["South Dakota","Pierre"],["Tennessee","Nashville"],["Texas","Austin"],["Utah","Salt Lake City"],["Vermont","Montpelier"],["Virginia","Richmond"],["Washington","Olympia"],["West Virginia","Charleston"],["Wisconsin","Madison"],["Wyoming","Cheyenne"]];
const CAPITALS_BY_INITIAL=STATES.reduce((a,[s,c])=>{const i=c[0].toUpperCase();(a[i]||(a[i]=[])).push([s,c]);return a;},{});

// Only sound-alike AND existing in capitals
const RAW_MAP={alpha:'A',beta:'B',delta:'D',epsilon:'E',theta:'T',iota:'I',lambda:'L',mu:'M',omicron:'O',pi:'P',rho:'R',sigma:'S',tau:'T',phi:'F',omega:'O'};
const GREEK_TO_LATIN=Object.fromEntries(Object.entries(RAW_MAP).filter(([g,l])=>CAPITALS_BY_INITIAL[l]));

// Blocks game word->greek-name sequences
const BLOCKS_DATA=[
{latin:'meta',greek:['mu','epsilon','tau','alpha']},
{latin:'micro',greek:['mu','iota','kappa','rho','omicron']},
{latin:'macro',greek:['mu','alpha','kappa','rho','omicron']},
{latin:'bio',greek:['beta','iota','omicron']},
{latin:'geo',greek:['gamma','epsilon','omicron']},
{latin:'psycho',greek:['psi','upsilon','chi','omicron']},
{latin:'photo',greek:['phi','omicron','tau','omicron']},
{latin:'chrono',greek:['chi','rho','omicron','nu','omicron']},
{latin:'biblio',greek:['beta','iota','beta','lambda','iota','omicron']}
];

const STORAGE_KEY="greek_trainer_progress_v4";
const $=s=>document.querySelector(s), $$=s=>Array.from(document.querySelectorAll(s)), rand=a=>a[Math.floor(Math.random()*a.length)];
function loadProgress(){try{const raw=localStorage.getItem(STORAGE_KEY);return raw?JSON.parse(raw):{learned:{},score:{right:0,total:0}}}catch(e){return{learned:{},score:{right:0,total:0}}}
function saveProgress(p){localStorage.setItem(STORAGE_KEY,JSON.stringify(p));renderProgress();renderLettersList()}
let PROG=loadProgress();

$$(".tab-btn").forEach(btn=>btn.addEventListener("click",()=>{$$(".tab-btn").forEach(b=>b.classList.remove("active"));btn.classList.add("active");["learn","trace","quiz","progress","blocks"].forEach(id=>{document.getElementById(id).hidden=id!==btn.dataset.tab})}));

let idx=0;
function renderLearn(){const L=LETTERS[idx];$("#glyphUpper").textContent=L.u;$("#glyphLower").textContent=L.l;$("#name").textContent=L.name;$("#pron").textContent=`${L.pron}${L.alt?" â€¢ aka "+L.alt.join(", "):""}`;$("#usage").textContent=L.usage;const learned=!!PROG.learned[L.name];$("#markLearned").classList.toggle("learned-state",learned);$("#markLearned").disabled=learned;$("#resetLearned").disabled=!learned;$("#traceSelect").value=L.name;updateGhost()}
document.getElementById("prevLetter").addEventListener("click",()=>{idx=(idx-1+LETTERS.length)%LETTERS.length;renderLearn()});
document.getElementById("nextLetter").addEventListener("click",()=>{idx=(idx+1)%LETTERS.length;renderLearn()});
function renderLettersList(){const w=$("#lettersList");w.innerHTML="";LETTERS.forEach((L,i)=>{const d=document.createElement("button");d.className="pill"+(PROG.learned[L.name]?" learned":"");d.dataset.name=L.name;d.innerHTML=`<span class="upper">${L.u}</span><span class="lower">${L.l}</span><div style="font-size:12px">${L.name}</div>`;d.addEventListener("click",()=>{idx=i;renderLearn()});w.appendChild(d)})}
document.getElementById("markLearned").addEventListener("click",()=>{PROG.learned[LETTERS[idx].name]=true;saveProgress(PROG);renderLearn()});
document.getElementById("resetLearned").addEventListener("click",()=>{delete PROG.learned[LETTERS[idx].name];saveProgress(PROG);renderLearn()});

const voiceSel=$("#voiceSelect");let voices=[];function loadVoices(){voices=speechSynthesis.getVoices().filter(v=>v.lang.startsWith("en"));voiceSel.innerHTML=voices.map((v,i)=>`<option value="${i}">${v.name} â€” ${v.lang}${v.default?" (default)":""}</option>`).join("")}
loadVoices();window.speechSynthesis.onvoiceschanged=loadVoices;
function speak(t){const u=new SpeechSynthesisUtterance(t);const i=+voiceSel.value;if(voices[i])u.voice=voices[i];u.rate=.95;u.pitch=1.0;speechSynthesis.cancel();speechSynthesis.speak(u)}
document.getElementById("speakBtn").addEventListener("click",()=>{const L=LETTERS[idx];speak(`${L.name} â€” ${L.pron}`)});

// Trace
const traceSel=document.getElementById("traceSelect");traceSel.innerHTML=LETTERS.map(L=>`<option value="${L.name}">${L.name}</option>`).join("");
document.getElementById("traceCase").addEventListener("change",updateGhost);
traceSel.addEventListener("change",()=>{clearCanvas();updateGhost()});
function updateGhost(){const L=LETTERS.find(x=>x.name===document.getElementById("traceSelect").value)||LETTERS[idx];const isUpper=document.getElementById("traceCase").value==="upper";document.getElementById("ghost").textContent=isUpper?L.u:L.l}
const canvas=document.getElementById("pad"), ctx=canvas.getContext("2d");ctx.lineWidth=14;ctx.lineCap="round";ctx.lineJoin="round";ctx.strokeStyle="#e5e7eb";let drawing=false,last=null;
function pos(e){const r=canvas.getBoundingClientRect();const x=(e.touches?e.touches[0].clientX:e.clientX)-r.left;const y=(e.touches?e.touches[0].clientY:e.clientY)-r.top;const sx=canvas.width/r.width,sy=canvas.height/r.height;return{x:x*sx,y:y*sy}}
function start(e){drawing=true;last=pos(e)}function move(e){if(!drawing)return;const p=pos(e);ctx.beginPath();ctx.moveTo(last.x,last.y);ctx.lineTo(p.x,p.y);ctx.stroke();last=p;e.preventDefault()}function end(){drawing=false;last=null}
;["mousedown","touchstart"].forEach(ev=>canvas.addEventListener(ev,start,{passive:false}));["mousemove","touchmove"].forEach(ev=>canvas.addEventListener(ev,move,{passive:false}));["mouseup","mouseleave","touchend","touchcancel"].forEach(ev=>canvas.addEventListener(ev,end,{passive:true}));
function clearCanvas(){ctx.clearRect(0,0,canvas.width,canvas.height)}document.getElementById("erase").addEventListener("click",clearCanvas);
document.getElementById("savePNG").addEventListener("click",()=>{const a=document.createElement("a");const L=LETTERS.find(x=>x.name===document.getElementById("traceSelect").value);const which=document.getElementById("traceCase").value==="upper"?L.u:L.l;a.download=`trace-${L.name}-${which}.png`;a.href=canvas.toDataURL("image/png");a.click()});

// Quiz
const scoreEl=document.getElementById("score"),scoreOutOfEl=document.getElementById("scoreOutOf"),roundEl=document.getElementById("roundN"),roundTotalEl=document.getElementById("roundTotal");
let roundSize=10,qCount=0;function resetRound(){qCount=0;roundSize=+document.getElementById("roundSize").value;PROG.score={right:0,total:0};scoreOutOfEl.textContent=roundSize;roundTotalEl.textContent=roundSize;renderScore()}
document.getElementById("roundSize").addEventListener("change",resetRound);
function renderScore(){scoreEl.textContent=PROG.score?.right??0}function incScore(ok){PROG.score.total++;if(ok)PROG.score.right++;renderScore()}
function pickScope(){const s=document.getElementById("quizScope").value;if(s==="learned")return LETTERS.filter(L=>PROG.learned[L.name]);if(s==="unlearned")return LETTERS.filter(L=>!PROG.learned[L.name]);return LETTERS.slice()}
function newRound(){resetRound();document.getElementById("qText").textContent="Round started â€” answer the question below.";askQuestion()}
document.getElementById("newQ").addEventListener("click",newRound);
function askQuestion(){if(qCount>=roundSize){alert(`Round complete! Score: ${PROG.score.right}/${roundSize}`);document.getElementById("qText").textContent="Pick a mode and start a new round.";document.getElementById("quizOptions").innerHTML="";document.getElementById("quizFree").innerHTML="";return}
qCount++;roundEl.textContent=qCount;const mode=document.getElementById("quizMode").value;const pool=pickScope();const answer=rand(pool);document.getElementById("quizOptions").innerHTML="";document.getElementById("quizFree").innerHTML="";
if(mode==="see-name"){const shown=Math.random()<.5?answer.u:answer.l;document.getElementById("qText").innerHTML=`What is the <b>name</b> of this letter? <span class="glyph" style="font-size:72px;display:inline-block;vertical-align:middle">${shown}</span>`;const opts=new Set([answer.name]);while(opts.size<4)opts.add(rand(LETTERS).name);[...opts].sort(()=>Math.random()-.5).forEach(name=>{const b=document.createElement("button");b.textContent=name;b.addEventListener("click",()=>{const ok=name===answer.name;b.classList.add(ok?"correct":"incorrect");incScore(ok);askQuestion()});document.getElementById("quizOptions").appendChild(b)})}
else if(mode==="hear-letter"){document.getElementById("qText").textContent="Listen and pick the letter:";speak(`${answer.name} â€” ${answer.pron}`);const shown=Math.random()<.5?answer.u:answer.l;const choices=new Set([shown]);while(choices.size<4){const r=rand(pool);choices.add(Math.random()<.5?r.u:r.l)}[...choices].sort(()=>Math.random()-.5).forEach(glyph=>{const b=document.createElement("button");b.innerHTML=`<span style="font-size:32px">${glyph}</span>`;b.addEventListener("click",()=>{const ok=glyph===shown;b.classList.add(ok?"correct":"incorrect");incScore(ok);askQuestion()});document.getElementById("quizOptions").appendChild(b)})}
else if(mode==="type-name"){const shown=Math.random()<.5?answer.u:answer.l;document.getElementById("qText").innerHTML=`Type the <b>name</b> of this letter: <span class="glyph" style="font-size:72px;display:inline-block;vertical-align:middle">${shown}</span>`;const input=document.createElement("input");input.type="text";input.placeholder="e.g., alpha";const btn=document.createElement("button");btn.textContent="Check";btn.className="primary";const fb=document.createElement("div");fb.className="pron";document.getElementById("quizFree").append(input,btn,fb);btn.addEventListener("click",()=>{const val=input.value.trim().toLowerCase();const ok=[answer.name,...(answer.alt||[])].map(s=>s.toLowerCase()).includes(val);fb.textContent=ok?"Correct!":`Incorrect. Answer: ${answer.name}`;fb.style.color=ok?"var(--good)":"var(--bad)";incScore(ok);askQuestion()})}
else if(mode==="state-capital"){const validGreek=Object.keys(GREEK_TO_LATIN);const g=rand(LETTERS.filter(L=>validGreek.includes(L.name)));const mapped=GREEK_TO_LATIN[g.name];const pairs=CAPITALS_BY_INITIAL[mapped];const correct=rand(pairs);const shown=Math.random()<.5?g.u:g.l;document.getElementById("qText").innerHTML=`Pick the <b>U.S. state</b> whose <i>capital</i> starts with: <b>${mapped}</b><br/>(Closest English initial to the Greek letter) <span class="glyph" style="font-size:72px;display:inline-block;vertical-align:middle">${shown}</span>`;const choices=new Set([correct[0]]);while(choices.size<4){const other=rand(STATES.filter(([s,c])=>s!==correct[0]));choices.add(other[0])}[...choices].sort(()=>Math.random()-.5).forEach(stateName=>{const b=document.createElement("button");b.textContent=stateName;b.addEventListener("click",()=>{const ok=stateName===correct[0];b.classList.add(ok?"correct":"incorrect");document.getElementById("qText").innerHTML=`Correct answer: ${correct[0]} (capital ${correct[1]}).`;incScore(ok);askQuestion()});document.getElementById("quizOptions").appendChild(b)})}}
function renderProgress(){const w=document.getElementById("progressList");w.innerHTML="";LETTERS.forEach(L=>{const learned=!!PROG.learned[L.name];const d=document.createElement("div");d.className="pill"+(learned?" learned":"");d.innerHTML=`<span class="upper">${L.u}</span><span class="lower">${L.l}</span><div style="font-size:12px">${L.name}</div>`;w.appendChild(d)})}
document.getElementById("resetAll").addEventListener("click",()=>{if(!confirm("Reset all learned flags and current round score?"))return;PROG={learned:{},score:{right:0,total:0}};saveProgress(PROG);renderLearn();renderScore()});
// Blocks game
const BLOCKS=document.getElementById("blocks");const TARGET_LATIN=document.getElementById("targetLatin");const BLOCKS_FEED=document.getElementById("blocksFeedback");
function newBlocks(){const item=rand(BLOCKS_DATA);TARGET_LATIN.textContent=item.latin;BLOCKS_FEED.textContent="Drag letters to match the Greek spelling order.";BLOCKS.innerHTML="";const seq=item.greek.map(n=>LETTERS.find(L=>L.name===n));const shuffled=seq.slice().sort(()=>Math.random()-.5);shuffled.forEach(L=>{const el=document.createElement("div");el.className="block";el.draggable=true;el.textContent=Math.random()<.5?L.u:L.l;el.dataset.name=L.name;el.addEventListener("dragstart",e=>{e.dataTransfer.setData("text/plain",L.name);e.dataTransfer.effectAllowed="move";el.classList.add("dragging")});el.addEventListener("dragend",()=>el.classList.remove("dragging"));BLOCKS.appendChild(el)})}
document.getElementById("newBlocks").addEventListener("click",newBlocks);
BLOCKS.addEventListener("dragover",e=>{e.preventDefault();const dragging=document.querySelector(".block.dragging");const others=Array.from(BLOCKS.querySelectorAll(".block:not(.dragging)"));let placed=false;for(const el of others){const r=el.getBoundingClientRect();if(e.clientX<r.left+r.width/2){BLOCKS.insertBefore(dragging,el);placed=true;break}}if(!placed&&dragging)BLOCKS.appendChild(dragging)});
BLOCKS.addEventListener("drop",e=>{e.preventDefault();const names=Array.from(BLOCKS.querySelectorAll(".block")).map(b=>b.dataset.name);const item=BLOCKS_DATA.find(x=>x.latin===TARGET_LATIN.textContent);const ok=JSON.stringify(names)===JSON.stringify(item.greek);BLOCKS_FEED.textContent=ok?"âœ… Nice! That's the correct Greek sequence.":"âŒ Not quite â€” keep rearranging.";BLOCKS_FEED.style.color=ok?"var(--good)":"var(--bad)"});
// init
function init(){document.getElementById("traceSelect").innerHTML=LETTERS.map(L=>`<option value="${L.name}">${L.name}</option>`).join("");renderLettersList();renderLearn();renderProgress();resetRound();newBlocks()}init();
</script></body></html>
